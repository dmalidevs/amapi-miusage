document.addEventListener("click",function(t){(t.target.classList.contains("close")||t.target.classList.contains("notice-dismiss"))&&t.target.parentElement.remove()});const g=async(t,e=null,a="POST")=>{const n=new FormData;n.append("action",t),n.append("nonce",amapi_data.nonce),n.append("data",JSON.stringify(e));const s=await fetch(amapi_data.ajaxurl,{method:a,body:n});if(!s.ok)throw new Error("Network response was not ok");return s.json()};function y(t="success",e="Success",a=1e3){document.getElementById("amapi-toast-wrap");const n=document.getElementById("toast_message");n.innerHTML=`<div class="notice notice-${t} notice-alt is-dismissible"><p>${e}</p><button type="button" class="notice-dismiss"><span class="screen-reader-text">Dismiss this notice.</span></button></div>`,n.style.display="block",setTimeout(()=>{n.innerHTML=""},a)}function b(t,e,a){return t=String(t).padStart(2,"0"),e=String(e).padStart(2,"0"),a=String(a).padStart(2,"0"),t+":"+e+":"+a}function h(t){let e=document.getElementById("inline_notice"),[a,n,s]=t.split(":").map(Number),i=a*3600+n*60+s,l=setInterval(function(){let m=Math.floor(i/3600),u=Math.floor(i%3600/60),p=i%60,f=b(m,u,p);e.textContent=`Countdown: ${f}`,i--,i<0&&(clearInterval(l),e.textContent="Countdown over! Refresh data with a click here â†’")},1e3)}const d=document.getElementById("amapi_refresh_button"),o=document.getElementById("amapi-page-content"),c=document.getElementById("ajax_loader");document.addEventListener("DOMContentLoaded",async()=>{r(o,!1),o&&d&&d.addEventListener("click",async t=>{r(o,!0)})});function r(t,e=!1){e&&(c.style.display="block"),g("amapi_refresh_data",{is_event:!!e}).then(a=>{setTimeout(()=>{h(a.data.remaining)}),e&&a.success&&(t.innerHTML=w(a.data)),e&&y(a.success?"success":"warning",a.data.message,2e3),c.style.display="none"})}const w=t=>{let e=`<tr>${t.data.headers.map(n=>`<th>${n}</th>`).join("")}</tr>`,a=Object.keys(t.data.rows).map(n=>{let s=t.data.rows[n];return`<tr><td>${s.id}</td><td>${s.fname}</td><td>${s.lname}</td><td>${s.email}</td><td>${s.date}</td></tr>`}).join("");return`<h3 class="amapi-table-title">${t.title}</h3><table class="wp-list-table widefat fixed striped table-view-list datas amapi-datatable"><thead>${e}</thead><tbody>${a}</tbody></table>`};
